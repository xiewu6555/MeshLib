# 刀具路径生成器插件使用指南

## 简介

刀具路径生成器是一个MRViewer插件，提供了强大的CAM刀具路径生成和可视化功能，支持三种典型的工具路径算法：分层水平割线路径（Lacing）、等高加工路径（Constant-Z）和等余量加工路径（Constant-Cusp）。该插件为CNC编程人员提供了一个直观的界面，可以快速生成、可视化、比较和导出不同类型的刀具路径。

## 主要特性

- **多算法支持**：提供三种常用的刀具路径生成算法
- **交互式参数调整**：实时调整刀具参数和算法参数
- **动态可视化**：以不同颜色显示不同类型的刀具路径
- **路径动画**：模拟刀具沿路径的运动
- **多视图比较**：同时查看不同算法生成的刀具路径
- **路径分析**：切片分析、长度计算和加工时间估算
- **模型检查**：自动检测倒角区域和网格问题
- **参数预设**：支持粗加工、半精加工和精加工的参数预设
- **导出功能**：支持导出为G代码、APT/CL和CSV格式

## 安装

刀具路径生成器插件已集成到MRViewer中，无需单独安装。确保在编译MRViewer时已包含该插件。

## 使用方法

### 启动插件

1. 启动MRViewer应用程序
2. 点击菜单`工具 -> 刀具路径生成器`打开插件面板
3. 也可以使用快捷键`Ctrl+T`打开插件面板

### 基本工作流程

1. **导入模型**：
   - 点击`导入STEP模型`按钮或使用菜单`文件 -> 导入STEP模型...`
   - 也可以直接拖放STEP文件到MRViewer窗口

2. **配置刀具参数**：
   - 在`刀具参数`面板中选择刀具类型（球头铣刀、平头铣刀、环形铣刀）
   - 调整刀具半径、体素大小、安全高度等参数
   - 可以使用预设按钮快速应用粗加工、半精加工或精加工的参数配置

3. **选择算法和设置参数**：
   - 在`算法参数`面板中选择加工策略（分层水平割线路径、等高加工路径、等余量加工路径）
   - 根据选择的算法调整相应的参数

4. **生成刀具路径**：
   - 点击`生成当前选择算法路径`按钮
   - 路径生成后会在3D视图中显示，并在`路径生成`面板中显示状态和基本信息

5. **可视化和分析**：
   - 使用`动画控制`面板播放刀具沿路径的运动动画
   - 使用`多视图控制`面板同时查看和比较不同算法的路径
   - 使用`路径分析`面板进行切片分析和路径长度比较

6. **导出结果**：
   - 点击菜单`文件 -> 导出工具路径...`
   - 选择导出格式（G代码、APT/CL或CSV）
   - 指定保存路径和文件名

### 多视图模式

多视图模式允许您同时查看不同算法生成的刀具路径，便于比较：

1. 在`多视图控制`面板中勾选`启用多视图`
2. 选择布局类型：2x2网格、水平分割或垂直分割
3. 为每个视图配置显示的路径类型
4. 可选择`同步视角`以在所有视图之间同步旋转和缩放操作

### 路径分析功能

1. **切片分析**：
   - 在`路径分析`面板中勾选`显示切片平面`
   - 调整切片高度以查看不同高度处的路径截面
   - 系统会显示每种路径在当前高度的交点数量

2. **路径对比**：
   - 点击`计算并对比路径长度`按钮
   - 查看不同路径的长度对比和加工时间估算

### 键盘快捷键

- `Ctrl+T`：打开刀具路径生成器面板
- `Ctrl+I`：导入STEP模型
- `Ctrl+E`：导出工具路径
- `G`：生成当前选择算法的路径
- `空格键`：开始/停止动画

## 参数说明

### 刀具参数

- **刀具类型**：选择球头铣刀、平头铣刀或环形铣刀
- **刀具半径**：影响刀具的实际尺寸和加工精度
- **体素大小**：影响刀具路径的计算精度，较小的值提供更高的精度但需要更多计算时间
- **安全高度**：刀具在不加工时移动的高度，应确保不会与工件碰撞
- **进给率**：加工时的进给速度，包括加工进给率、下刀进给率和抬刀进给率

### 分层水平割线路径参数

- **割削方向**：决定刀具沿X轴还是Y轴切削
- **分层步长**：相邻两层之间的高度差，较小的值会增加加工精度但延长加工时间
- **临界过渡长度**：当相邻路径点的距离小于此值时，刀具将沿表面移动，否则通过安全高度
- **绕行方向**：顺时针或逆时针

### 等高加工路径参数

- **分层步长**：相邻等高层之间的高度差
- **临界过渡长度**：当相邻路径点的距离小于此值时，刀具将沿表面移动，否则通过安全高度
- **绕行方向**：顺时针或逆时针

### 等余量加工路径参数

- **余量步长**：控制相邻刀具路径之间的步长，直接影响曲面质量和加工效率
- **从中心到边界**：如果选中，加工路径将从中心向外扩展；否则从边界向内收缩
- **绕行方向**：顺时针或逆时针

## 可能遇到的问题和解决方案

1. **导入STEP模型失败**
   - 确保STEP文件格式正确且未损坏
   - 尝试使用较小或较简单的模型进行测试

2. **工具路径生成缓慢**
   - 减小体素大小可以提高性能，但会降低精度
   - 对于复杂模型，可以通过预处理简化网格

3. **路径中存在不合理的跨越**
   - 增加临界过渡长度以减少安全高度移动
   - 检查模型是否存在断开的部分或孤立区域

4. **倒角区域警告**
   - 系统会自动检测并标记无法用3轴加工的倒角区域
   - 考虑修改模型设计或使用5轴加工策略

## 开发者信息

刀具路径生成器插件是MeshLib项目的一部分，基于CGAL、OpenCascade等开源库开发。插件源代码位于：
```
/source/MRViewer/MRToolPathPlugin.h
/source/MRViewer/MRToolPathPlugin.cpp
```

如需贡献代码或报告问题，请联系项目维护者。

## 许可证

本插件遵循MeshLib项目的许可证条款。 